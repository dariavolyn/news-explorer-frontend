(this["webpackJsonpnews-explorer-frontend"]=this["webpackJsonpnews-explorer-frontend"]||[]).push([[0],{27:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(20),o=n.n(c),i=(n(27),n(2)),r=n(3),l=n(8),p=n(0);var u=function(e){return Object(p.jsx)("section",{className:"popup popup_type_".concat(e.type," ").concat(e.isOpen?"popup_is_open":""),children:Object(p.jsxs)("div",{className:"popup__container popup__containter_type_form",children:[Object(p.jsx)("button",{type:"button","aria-label":"close",className:"button popup__close",onClick:e.onClose}),Object(p.jsx)("h2",{className:"popup__title",children:e.title}),Object(p.jsxs)("form",{noValidate:!0,className:"popup__form",children:[e.children,Object(p.jsx)("button",{type:"submit",value:"submit",disabled:!1===e.isValid&&!0,className:"button popup__submit ".concat(!1===e.isValid&&"popup__submit_disabled"),onClick:e.formSubmit,children:e.buttonText}),Object(p.jsxs)("p",{className:"popup__form-alt",children:["or ",Object(p.jsx)(l.b,{to:e.altFormLink,onClick:e.openAltForm,className:"button popup__form-alt-link",children:e.altFormTitle})]})]})]})})},d=n(11),h=n(10);function j(){var e=s.a.useState({}),t=Object(i.a)(e,2),n=t[0],c=t[1],o=s.a.useState({}),r=Object(i.a)(o,2),l=r[0],p=r[1],u=s.a.useState(!1),j=Object(i.a)(u,2),_=j[0],b=j[1],m=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];c(e),p(t),b(n)}),[c,p,b]);return{values:n,handleChange:function(e){var t=e.target,a=t.name,s=t.value;console.log(_),c(Object(h.a)(Object(h.a)({},n),{},Object(d.a)({},a,s))),p(Object(h.a)(Object(h.a)({},l),{},Object(d.a)({},a,t.validationMessage))),b(t.closest("form").checkValidity())},errors:l,isValid:_,resetForm:m}}var _=function(e){var t=j(),n=t.values,a=t.handleChange,s=t.isValid,c=t.resetForm;return Object(p.jsxs)(u,{altFormLink:e.altFormLink,altFormTitle:e.altFormTitle,buttonText:"Sign in",formSubmit:function(t){t.preventDefault();var a=n.email,s=n.password;e.formSubmit(a,s),c()},isOpen:e.isOpen,isValid:s,title:"Sign in",type:"auth",openAltForm:e.openAltForm,onClose:e.onClose,children:[Object(p.jsx)("h6",{className:"popup__input-title popup__input-title_type_email",children:"Email"}),Object(p.jsx)("input",{minLength:"1",maxLength:"30",type:"email",className:"popup__input popup__input_type_email",placeholder:"Email",onChange:a,name:"email"}),Object(p.jsx)("span",{className:"popup__error ".concat(!1===s&&void 0!==n.email&&"popup__error_visible"),children:"Invalid email address"}),Object(p.jsx)("h6",{className:"popup__input-title popup__input-title_type_password",children:"Password"}),Object(p.jsx)("input",{minLength:"1",maxLength:"30",type:"text",className:"popup__input popup__input_type_password",placeholder:"Enter password",name:"password",required:!0,onChange:a}),Object(p.jsx)("span",{className:"popup__error ".concat(!e.isLoginSuccess&&"popup__error_visible"),children:"Incorrect email or password"})]})},b=s.a.createContext();var m=function(e){var t=s.a.useContext(b);return Object(p.jsx)("nav",{className:"nav nav_page_".concat(e.page,"\n         ").concat(e.isNavMobileOpen?"nav_is_open":"nav_is_hidden"),children:Object(p.jsxs)("div",{className:"nav__menu nav__menu_page_".concat(e.page," \n            ").concat(e.isNavMobileOpen?"nav__menu_is_open":""),children:[Object(p.jsx)("button",{className:"button nav__close nav__close_page_".concat(e.page),onClick:e.onClose,children:"+"}),Object(p.jsx)(l.b,{to:"/",className:"link nav__home nav__home_page_".concat(e.page),exact:!0,activeClassName:"nav__home_active",children:"Home"}),!1===e.isLoggedIn&&Object(p.jsx)(l.b,{to:"/signin",className:"link nav__signin",onClick:e.onAuth,children:"Sign in"}),!0===e.isLoggedIn&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(l.b,{to:"/saved-news",className:"button nav__saved-articles \n                            nav__saved-articles_page_".concat(e.page),exact:!0,activeClassName:"nav__saved-articles_active_page_".concat(e.page),children:"Saved articles"}),Object(p.jsx)("button",{className:"button nav__exit nav__exit_page_".concat(e.page),onClick:e.signOut,children:t.username})]})]})})};var O=function(e){return Object(p.jsx)("header",{className:"header header_page_".concat(e.page),children:Object(p.jsxs)("div",{className:"header__content",children:[Object(p.jsx)("h2",{className:"header__logo header__logo_page_".concat(e.page),children:"NewsExplorer"}),Object(p.jsx)("button",{className:"button \n                    header__nav-mobile-button \n                    header__nav-mobile-button_page_".concat(e.page),onClick:e.onOpen}),Object(p.jsx)(m,{currentUser:e.currentUser,handleRegisterOpen:e.handleRegisterOpen,isLoggedIn:e.isLoggedIn,isNavMobileOpen:e.isNavMobileOpen,onAuth:e.onAuth,onClose:e.closeNavMobile,page:e.page,signOut:e.handleSignOut})]})})},g=n.p+"static/media/github.c2b3aafb.svg",v=n.p+"static/media/fb_logo.673b4e8a.svg";var x=function(){return Object(p.jsxs)("footer",{className:"footer",children:[Object(p.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Supersite, Powered by News API"}),Object(p.jsxs)("nav",{className:"footer__links",children:[Object(p.jsx)(l.b,{className:"link footer__link link_type_home",to:"/",children:"Home"}),Object(p.jsx)("a",{className:"link footer__link link_type_practicum",href:"https://practicum.yandex.com/",target:"_blank",rel:"noreferrer",children:"Practicum by Yandex"}),Object(p.jsx)("a",{className:"link footer__link link_type_github",href:"https://github.com/dariavolyn",target:"_blank",rel:"noreferrer",children:Object(p.jsx)("img",{src:g,alt:"Github link"})}),Object(p.jsx)("a",{className:"link footer__link link_type_github",href:"https://www.facebook.com/daria.volyn",target:"_blank",rel:"noreferrer",children:Object(p.jsx)("img",{src:v,alt:"Facebook link"})})]})]})},f=n.p+"static/media/about-pic.9dd3ba50.jpeg";var N=function(){return Object(p.jsxs)("section",{className:"about",children:[Object(p.jsx)("img",{className:"about__picture",alt:"Author",src:f}),Object(p.jsxs)("div",{className:"about__text",children:[Object(p.jsx)("h3",{className:"about__title",children:"About the author"}),Object(p.jsx)("p",{className:"about__info",children:"This block describes the project author. Here you should indicate your name, what you do, and which development technologies you know."}),Object(p.jsx)("p",{className:"about__info",children:"You can also talk about your experience with Practicum, what you learned there, and how you can help potential customers."})]})]})},w=n(37),y=n(18),k=n.n(y);var S=function(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),s=n[0],c=n[1];return Object(p.jsxs)("li",{className:"news-card",children:[Object(p.jsx)("button",{className:"button news-card__link",children:e.image?Object(p.jsx)("img",{className:"news-card__picture",src:e.image,alt:"News cover",onClick:function(){window.open(e.link)}}):Object(p.jsx)("div",{className:"news-card__no-img-container",children:Object(p.jsx)("p",{className:"news-card__no-img",children:"No image"})})}),"saved-news"===e.page&&Object(p.jsxs)("button",{className:"button news-card__button news-card__delete",children:[Object(p.jsx)("p",{className:"news-card__picture-label",children:"Label"}),Object(p.jsx)("div",{className:"news-card__tooltip-wrap tooltip-wrap_type_delete",children:Object(p.jsx)("div",{className:"news-card__tooltip",children:Object(p.jsx)("p",{className:"news-card__tooltip-text",children:"Remove from saved"})})})]}),"main"===e.page&&Object(p.jsx)("button",{disabled:!1===e.isLoggedIn&&!0,onClick:function(){!0===s?c(!1):(e.onSave(e.card),c(!0))},className:"button news-card__button news-card__save ".concat(s?"news-card__saved":""),children:Object(p.jsx)("div",{className:"news-card__tooltip-wrap tooltip-wrap_type_save",children:!1===e.isLoggedIn&&Object(p.jsx)("div",{className:"news-card__tooltip",children:Object(p.jsx)("p",{className:"news-card__tooltip-text",children:"Sign in to save articles"})})})}),Object(p.jsxs)("div",{className:"news-card__content",children:[Object(p.jsx)("p",{className:"news-card__date",children:function(){k.a.locale("en");var t=e.date;return k()(t).format("DD MMMM YYYY")}()}),Object(p.jsx)("h2",{className:"news-card__title",children:e.title}),Object(p.jsx)("p",{className:"news-card__text",children:e.text}),Object(p.jsx)("p",{className:"news-card__source",children:e.source})]})]})};var C=function(e){return Object(p.jsxs)("section",{className:"news-list",children:["main"===e.page&&Object(p.jsx)("h3",{className:"news-list__title",children:"Search results"}),e.cards&&Object(p.jsx)("ul",{className:"news-list__cards",children:e.cards.slice(0,e.numberOfCards).map((function(t){return Object(p.jsx)(S,{card:t,date:t.publishedAt.toString(),image:t.urlToImage,isLoggedIn:e.isLoggedIn,keyword:e.keyword,link:t.url,page:e.page,search:e.search,source:t.source.name,onSave:e.onSave,text:t.content,title:t.title},Object(w.a)())}))}),"main"===e.page&&Object(p.jsx)("button",{className:"button news-list__show-more",type:"button",onClick:e.showMore,children:"Show more"})]})};var L=function(e){return Object(p.jsxs)("form",{className:"search-form",children:[Object(p.jsx)("input",{className:"search-form__bar",type:"text",id:"search",placeholder:"Enter topic",onChange:e.onChange,value:e.search}),Object(p.jsx)("button",{className:"button search-form__submit",type:"submit",value:"Search",onClick:function(t){t.preventDefault(),e.onSubmit(e.search)},children:"Search"})]})};var F=function(e){return Object(p.jsxs)("div",{className:"preloader ".concat(e.isOpen?"":"preloader_hide"),children:[Object(p.jsx)("i",{className:"preloader__circle"}),Object(p.jsx)("p",{className:"preloader__text",children:"Searching for news..."})]})},I=n.p+"static/media/not-found_v1.5661906d.svg";var A=function(e){return Object(p.jsxs)("div",{className:"nothing-found ".concat(e.isOpen?"":"nothing-found_hide"),children:[Object(p.jsx)("img",{className:"nothing-found__icon",alt:"Nothing found",src:I}),Object(p.jsx)("h3",{className:"nothing-found__title",children:"Nothing found"}),Object(p.jsx)("p",{className:"nothing-found__message",children:"Sorry, but nothing matched your search terms."})]})};var T=function(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),s=n[0],c=n[1],o=Object(a.useState)(3),r=Object(i.a)(o,2),l=r[0],u=r[1];return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsx)("div",{className:"intro",children:Object(p.jsxs)("div",{className:"intro__text",children:[Object(p.jsx)("h1",{className:"intro__title",children:"What's going on in the world?"}),Object(p.jsx)("h2",{className:"intro__subtitle",children:"Find the latest news on any topic and save them in your personal account."}),Object(p.jsx)(L,{onSubmit:function(){u(3),e.searchCards(s)},search:s,onChange:function(e){c(e.target.value)}})]})}),Object(p.jsx)(F,{isOpen:e.isPreloaderOpen}),e.cards&&Object(p.jsx)(C,{cards:e.cards,keyword:e.keyword,isLoggedIn:e.isLoggedIn,numberOfCards:l,page:e.page,search:s,showMore:function(){u((function(e){return e+3}))},onSave:e.onSave}),Object(p.jsx)(A,{isOpen:e.isNothingFoundOpen}),Object(p.jsx)(N,{})]})};var U=function(e){var t=j(),n=t.values,a=t.handleChange,s=t.isValid,c=t.resetForm;return Object(p.jsxs)(u,{altFormLink:e.altFormLink,altFormTitle:e.altFormTitle,buttonText:"Sign up",formSubmit:function(t){var a=n.email,s=n.password,o=n.username;t.preventDefault(),e.formSubmit(a,s,o),c()},isOpen:e.isOpen,isValid:s,openAltForm:e.openAltForm,onClose:e.onClose,title:"Sign up",type:"register",children:[Object(p.jsx)("h6",{className:"popup__input-title popup__input-title_type_email",children:"Email"}),Object(p.jsx)("input",{minLength:"1",maxLength:"30",type:"email",name:"email",className:"popup__input popup__input_type_email",placeholder:"Email",onChange:a}),Object(p.jsx)("span",{className:"popup__error ".concat(!1===s&&"popup__error_visible"),children:"Invalid email address"}),Object(p.jsx)("h6",{className:"popup__input-title popup__input-title_type_password",children:"Password"}),Object(p.jsx)("input",{minLength:"1",maxLength:"30",type:"text",name:"password",className:"popup__input popup__input-password",placeholder:"Enter password",onChange:a}),Object(p.jsx)("h6",{className:"popup__input-title popup__input_title_type_username",children:"Username"}),Object(p.jsx)("input",{minLength:"1",maxLength:"30",type:"text",name:"username",className:"popup__input popup__input_type_username",placeholder:"Username",onChange:a}),Object(p.jsx)("span",{className:"popup__error",children:"This email is not available"})]})};var E=function(e){var t=s.a.useContext(b);return Object(p.jsxs)("div",{className:"saved-news__text",children:[Object(p.jsx)("h3",{className:"saved-news__title",children:"Saved articles"}),Object(p.jsxs)("h2",{className:"saved-news__intro-amount",children:[t.username,", you have 5 saved articles"]}),Object(p.jsxs)("p",{className:"saved-news__keywords",children:["By keywords: ",Object(p.jsx)("span",{style:{fontWeight:"bold"},children:"Nature, Yellowstone, and 2 other"})]})]})};var M=function(e){return console.log("savednews",e.cards),Object(p.jsxs)("div",{className:"saved-news",children:[Object(p.jsx)(O,{isLoggedIn:e.isLoggedIn,isNavMobileOpen:e.isNavMobileOpen,onClose:e.onClose,onOpen:e.onOpen,page:e.page,handleSignOut:e.handleSignOut}),Object(p.jsx)(E,{})]})};var P=function(e){return Object(p.jsx)("section",{className:"popup popup_type_success ".concat(e.isOpen?"popup_is_open":""),children:Object(p.jsxs)("div",{className:"popup__container popup__container_type_success",children:[Object(p.jsx)("button",{type:"button","aria-label":"close",className:"button popup__close",onClick:e.onClose}),Object(p.jsx)("h2",{className:"popup__title",children:"Registration successfully completed!"}),Object(p.jsx)("button",{onClick:e.openAuth,className:"button popup__success-singin",children:"Sign in"})]})})},R=n(13),D=n(14);var V=new(function(){function e(t){var n=t.newsUrl,a=t.headers;Object(R.a)(this,e),this.newsUrl=n,this.headers=a}return Object(D.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getCardsList",value:function(e){return fetch("".concat(this.newsUrl,"/everything?q=").concat(e,"&from=").concat(new Date(Date.now()-6048e5).toISOString().slice(0,10),"&to=").concat((new Date).toISOString().slice(0,10),"&pageSize=10&apiKey=c4ef0e54c94849e194ad5251b2d39e56"),{method:"GET",headers:this.headers}).then(this._checkResponse)}}]),e}())({newsUrl:"https://nomoreparties.co/news/v2",headers:{"Content-Type":"application/json"}}),Y=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(R.a)(this,e),this.baseUrl=n,this.headers=a}return Object(D.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():console.log("Error: ".concat(e.status))}},{key:"registerUser",value:function(e,t,n){return fetch("".concat(this.baseUrl,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,username:n})}).then(this._checkResponse)}},{key:"authorizeUser",value:function(e,t){return fetch("".concat(this.baseUrl,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(this._checkResponse).then((function(e){return e.token?(localStorage.setItem("token",e.token),e):void 0}))}},{key:"getContent",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse).then((function(e){return e}))}},{key:"getUserInfo",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse)}},{key:"saveArticle",value:function(e,t,n){var a=n.description,s=n.publishedAt,c=n.source,o=n.title,i=n.url,r=n.urlToImage;return fetch("".concat(this.baseUrl,"/articles"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({keyword:t,description:a,publishedAt:s,source:c.name,title:o,url:i,urlToImage:r})}).then(this._checkResponse)}},{key:"getSavedArticles",value:function(){return fetch("".concat(this.baseUrl,"/articles"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(this._checkResponse)}}]),e}())({baseUrl:"https://api.daria-news.students.nomoreparties.site"});var z=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),l=Object(i.a)(o,2),u=l[0],d=l[1],h=Object(a.useState)([]),j=Object(i.a)(h,2),m=j[0],g=j[1],v=Object(a.useState)({}),f=Object(i.a)(v,2),N=f[0],w=f[1],y=Object(a.useState)([]),k=Object(i.a)(y,2),S=k[0],C=k[1],L=Object(a.useState)(!1),F=Object(i.a)(L,2),I=F[0],A=F[1],E=Object(a.useState)(!1),R=Object(i.a)(E,2),D=R[0],z=R[1],B=Object(a.useState)(!1),G=Object(i.a)(B,2),J=G[0],H=G[1],q=Object(a.useState)(!1),W=Object(i.a)(q,2),K=W[0],Q=W[1],X=Object(a.useState)(!1),Z=Object(i.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(i.a)(te,2),ae=ne[0],se=ne[1],ce=Object(a.useState)(!1),oe=Object(i.a)(ce,2),ie=oe[0],re=oe[1],le=Object(r.f)();function pe(){se(!1),H(!1),A(!0),le.push("/signin")}function ue(){A(!1),H(!0)}function de(){Q(!0)}function he(){se(!1),H(!1),A(!1),le.push("/")}function je(){Q(!1)}function _e(){localStorage.removeItem("token"),w({}),z(!1),le.push("/")}return Object(a.useEffect)((function(){var e=function(e){27===e.keyCode&&he()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}})),Object(a.useEffect)((function(){var e=localStorage.getItem("token");e&&Y.getContent(e).then((function(){C(e),z(!0)})).catch((function(e){return console.log(e)}))}),[]),s.a.useEffect((function(){var e=localStorage.getItem("token");e&&Y.getUserInfo(e).then((function(e){w({username:e.user.username,_id:e.user._id})})).catch((function(e){return console.log(e)}))}),[]),console.log("app.js",u),console.log(u),console.log(u.article),Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.Provider,{value:N,children:Object(p.jsxs)("div",{className:"app",children:[Object(p.jsxs)(r.c,{children:[Object(p.jsx)(r.a,{exact:!0,path:"/saved-news"}),Object(p.jsxs)(r.a,{path:"/",children:[Object(p.jsx)(O,{closeNavMobile:je,isLoggedIn:D,isNavMobileOpen:K,handleRegisterOpen:ue,handleSignOut:_e,onAuth:pe,onClose:he,onOpen:de,page:"main"}),Object(p.jsx)(T,{cards:n.articles,keyword:m,isLoggedIn:D,isNothingFoundOpen:$,isPreloaderOpen:ie,searchCards:function(e){re(!0),ee(!1),c([]),V.getCardsList(e).then((function(t){0===t.totalResults?ee(!0):(g(e),c(t))})).then((function(){re(!1)})).catch((function(e){return console.log(e)}))},onSave:function(e){Y.saveArticle(S,m,e).then((function(e){d(e),console.log("res:",e)})).catch((function(e){return console.log(e)})),console.log(u)},page:"main"}),Object(p.jsx)(M,{isLoggedIn:D,isNavMobileOpen:K,handleSignOut:_e,onClose:je,onOpen:de,page:"saved-news"})]})]}),Object(p.jsx)(r.a,{path:"/signin",children:Object(p.jsx)(_,{altFormTitle:"Sign up",altFormLink:"/signup",openAltForm:ue,isOpen:I,formSubmit:function(e,t){Y.authorizeUser(e,t).then((function(e){he(),z(!0),w({username:e.user}),le.push("/saved-news")})).catch((function(e){console.log(e)}))},onClose:he})}),Object(p.jsx)(r.a,{path:"/signup",children:Object(p.jsx)(U,{altFormTitle:"Sign in",altFormLink:"/signin",openAltForm:pe,isOpen:J,formSubmit:function(e,t,n){Y.registerUser(e,t,n).then((function(){H(!1),se(!0)})).catch((function(e){return console.log(e)}))},onClose:he})}),Object(p.jsx)(P,{isOpen:ae,openAuth:pe,onClose:he}),Object(p.jsx)(x,{})]})})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),c(e),o(e)}))};o.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(l.a,{children:Object(p.jsx)(z,{})})}),document.getElementById("root")),B()}},[[35,1,2]]]);
//# sourceMappingURL=main.261a9f0a.chunk.js.map