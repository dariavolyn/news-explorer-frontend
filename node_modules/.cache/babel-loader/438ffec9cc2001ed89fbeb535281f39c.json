{"ast":null,"code":"var _jsxFileName = \"/Users/dashon/Desktop/react-around-api-full/frontend/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { Redirect, Route, Switch, useHistory } from 'react-router-dom';\nimport AddPlacePopup from './AddPlacePopup.js';\nimport api from '../utils/api.js';\nimport auth from '../utils/auth.js';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext.js';\nimport EditAvatarPopup from './EditAvatarPopup.js';\nimport EditProfilePopup from './EditProfilePopup.js';\nimport Footer from './Footer.js';\nimport Header from './Header.js';\nimport ImagePopup from './ImagePopup.js';\nimport InfoToolTip from './InfoToolTip.js';\nimport Login from './Login.js';\nimport Main from './Main.js';\nimport { ProtectedRoute } from './ProtectedRoute.js';\nimport Register from './Register.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App(props) {\n  _s();\n\n  const [addPlacePopupOpen, setIsAddPlaceOpen] = useState(false);\n  const [cards, setCards] = useState([]);\n  const [currentUser, setCurrentUser] = useState({});\n  const [editAvatarPopupOpen, setIsEditAvatarOpen] = useState(false);\n  const [editProfilePopupOpen, setIsEditProfileOpen] = useState(false);\n  const [infoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const [selectedCard, setSelectedCard] = useState(null);\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [register, setRegister] = useState(false);\n  const [userData, setUserData] = useState({});\n  const history = useHistory(); // currentUser\n\n  React.useEffect(() => {\n    api.getUserInfo().then(res => {\n      setCurrentUser({ ...currentUser,\n        name: res.name,\n        about: res.about,\n        avatar: res.avatar,\n        _id: res._id\n      });\n    }).catch(err => {\n      console.log(err);\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // registering user\n\n  function handleRegister(email, password) {\n    auth.registerUser(email, password).then(res => {\n      handleInfoToolTipOpen();\n\n      if (res) {\n        setRegister(true);\n        history.push('/signin');\n      } else {\n        return;\n      }\n    }).catch(e => {\n      console.log(e);\n    });\n  } // checking token\n\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      auth.getContent(token).then(res => {\n        setLoggedIn(true);\n        setUserData(res.data);\n        history.push('/main');\n      }).catch(e => console.log(e));\n    }\n  }, []); // logging in\n\n  function handleLogin(email, password) {\n    auth.authorizeUser(email, password).then(res => {\n      setUserData(email);\n\n      if (res.token) {\n        setLoggedIn(true);\n        history.push('/main');\n      }\n    }).catch(err => console.log(err));\n  } // logging out\n\n\n  function handleLogOut() {\n    setUserData({});\n    setLoggedIn(false);\n  } // cards\n\n\n  useEffect(() => {\n    api.getCardsList().then(res => {\n      setCards(res);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n\n  function handleCardLike(card) {\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n\n    if (!isLiked) {\n      api.addLike(card._id).then(newCard => {\n        setCards(state => state.map(c => c._id === card._id ? newCard : c));\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      api.deleteLike(card._id).then(newCard => {\n        setCards(state => state.map(c => c._id === card._id ? newCard : c));\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }\n\n  function handleCardDelete(card) {\n    api.removeCard(card._id).then(() => {\n      const updatedList = cards.filter(c => c._id !== card._id);\n      setCards(updatedList);\n    }).catch(err => {\n      console.log(err);\n    });\n  } //popups \n\n\n  function handleAddPlaceOpen() {\n    setIsAddPlaceOpen(true);\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleEditAvatarOpen() {\n    setIsEditAvatarOpen(true);\n  }\n\n  function handleEditProfileOpen() {\n    setIsEditProfileOpen(true);\n  }\n\n  function handleInfoToolTipOpen() {\n    setIsInfoToolTipOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsAddPlaceOpen(false);\n    setIsEditAvatarOpen(false);\n    setIsEditProfileOpen(false);\n    setIsInfoToolTipOpen(false);\n    setSelectedCard(null);\n  }\n\n  function handleUpdateUser(newUser) {\n    api.setUserInfo({\n      name: newUser.name,\n      about: newUser.about\n    }).then(res => {\n      setCurrentUser({ ...currentUser,\n        name: newUser.name,\n        about: newUser.about\n      });\n    }).then(closeAllPopups).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleUpdateAvatar(newUser) {\n    api.setUserPic({\n      avatar: newUser.avatar\n    }).then(() => {\n      setCurrentUser({ ...currentUser,\n        avatar: newUser.avatar\n      });\n    }).then(closeAllPopups).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleAddPlaceSubmit(card) {\n    api.addCard({\n      name: card.name,\n      link: card.link\n    }).then(card => {\n      setCards([card, ...cards]);\n    }).then(closeAllPopups).catch(err => {\n      console.log(err);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        loggedIn: loggedIn,\n        userData: userData,\n        onLogOut: handleLogOut\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        onClose: closeAllPopups\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: addPlacePopupOpen,\n        onClose: closeAllPopups,\n        onAddPlace: handleAddPlaceSubmit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: editAvatarPopupOpen,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: editProfilePopupOpen,\n        onClose: closeAllPopups,\n        onUpdateUser: handleUpdateUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(InfoToolTip, {\n        isOpen: infoToolTipOpen,\n        onClose: closeAllPopups,\n        isRegistered: register\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          exact: true,\n          path: \"/main\",\n          loggedIn: loggedIn,\n          component: Main,\n          cards: cards,\n          handleCardClick: handleCardClick,\n          onAddPlace: handleAddPlaceOpen,\n          onCardDelete: handleCardDelete,\n          onCardLike: handleCardLike,\n          onClose: closeAllPopups,\n          onEditAvatar: handleEditAvatarOpen,\n          onEditProfile: handleEditProfileOpen\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signup\",\n          children: /*#__PURE__*/_jsxDEV(Register, {\n            onSubmit: handleRegister\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signin\",\n          children: /*#__PURE__*/_jsxDEV(Login, {\n            onSubmit: handleLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          children: loggedIn ? /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/main\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 31\n          }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/signin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 31\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 17\n      }, this), loggedIn && /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 30\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 223,\n    columnNumber: 9\n  }, this);\n}\n\n_s(App, \"c/nNRDk1TmXaQxo9Fir9NWsV5X8=\", false, function () {\n  return [useHistory];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/dashon/Desktop/react-around-api-full/frontend/src/components/App.js"],"names":["React","useState","useEffect","Redirect","Route","Switch","useHistory","AddPlacePopup","api","auth","CurrentUserContext","EditAvatarPopup","EditProfilePopup","Footer","Header","ImagePopup","InfoToolTip","Login","Main","ProtectedRoute","Register","App","props","addPlacePopupOpen","setIsAddPlaceOpen","cards","setCards","currentUser","setCurrentUser","editAvatarPopupOpen","setIsEditAvatarOpen","editProfilePopupOpen","setIsEditProfileOpen","infoToolTipOpen","setIsInfoToolTipOpen","selectedCard","setSelectedCard","loggedIn","setLoggedIn","register","setRegister","userData","setUserData","history","getUserInfo","then","res","name","about","avatar","_id","catch","err","console","log","handleRegister","email","password","registerUser","handleInfoToolTipOpen","push","e","token","localStorage","getItem","getContent","data","handleLogin","authorizeUser","handleLogOut","getCardsList","handleCardLike","card","isLiked","likes","some","i","addLike","newCard","state","map","c","deleteLike","handleCardDelete","removeCard","updatedList","filter","handleAddPlaceOpen","handleCardClick","handleEditAvatarOpen","handleEditProfileOpen","closeAllPopups","handleUpdateUser","newUser","setUserInfo","handleUpdateAvatar","setUserPic","handleAddPlaceSubmit","addCard","link"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Redirect, Route, Switch, useHistory } from 'react-router-dom';\n\nimport AddPlacePopup from './AddPlacePopup.js';\nimport api from '../utils/api.js';\nimport auth from '../utils/auth.js';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext.js';\nimport EditAvatarPopup from './EditAvatarPopup.js';\nimport EditProfilePopup from './EditProfilePopup.js';\nimport Footer from './Footer.js';\nimport Header from './Header.js';\nimport ImagePopup from './ImagePopup.js';\nimport InfoToolTip from './InfoToolTip.js';\nimport Login from './Login.js';\nimport Main from './Main.js';\nimport { ProtectedRoute } from './ProtectedRoute.js';\nimport Register from './Register.js';\n\n\nfunction App(props) {\n    const [addPlacePopupOpen, setIsAddPlaceOpen] = useState(false);\n    const [cards, setCards] = useState([]);\n    const [currentUser, setCurrentUser] = useState({});\n    const [editAvatarPopupOpen, setIsEditAvatarOpen] = useState(false);\n    const [editProfilePopupOpen, setIsEditProfileOpen] = useState(false);\n    const [infoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n    const [selectedCard, setSelectedCard] = useState(null);\n    const [loggedIn, setLoggedIn] = useState(false);\n    const [register, setRegister] = useState(false);\n    const [userData, setUserData] = useState({});\n    const history = useHistory();\n\n    // currentUser\n    React.useEffect(() => {\n        api.getUserInfo()\n            .then((res) => {\n                setCurrentUser({\n                    ...currentUser,\n                    name: res.name,\n                    about: res.about,\n                    avatar: res.avatar,\n                    _id: res._id\n                })\n            })\n            .catch((err) => {\n                console.log(err);\n            })\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n\n    // registering user\n    function handleRegister(email, password) {\n        auth.registerUser(email, password)\n            .then((res) => {\n                handleInfoToolTipOpen();\n                if (res) {\n                    setRegister(true);\n                    history.push('/signin');\n                }\n                else {\n                    return\n                }\n            }).catch(e => {\n                console.log(e);\n            })\n    }\n\n    // checking token\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        if (token) {\n            auth.getContent(token)\n                .then((res) => {\n                    setLoggedIn(true);\n                    setUserData(res.data);\n                    history.push('/main');\n                }\n                )\n                .catch((e) => console.log(e))\n        }\n    }, [])\n\n    // logging in\n    function handleLogin(email, password) {\n        auth.authorizeUser(email, password)\n            .then((res) => {\n                setUserData(email);\n                if (res.token) {\n                    setLoggedIn(true);\n                    history.push('/main');\n                }\n            })\n            .catch(err => console.log(err));\n    }\n\n    // logging out\n    function handleLogOut() {\n        setUserData({});\n        setLoggedIn(false);\n    }\n\n\n    // cards\n    useEffect(() => {\n        api.getCardsList()\n            .then((res) => {\n                setCards(res)\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    }, []);\n\n    function handleCardLike(card) {\n        const isLiked = card.likes.some(i => i._id === currentUser._id);\n\n        if (!isLiked) {\n            api.addLike(card._id)\n                .then((newCard) => {\n                    setCards((state) => state.map((c) => c._id === card._id ? newCard : c))\n                })\n                .catch((err) => {\n                    console.log(err);\n                })\n        }\n        else {\n            api.deleteLike(card._id)\n                .then((newCard) => {\n                    setCards((state) => state.map((c) => c._id === card._id ? newCard : c))\n                })\n                .catch((err) => {\n                    console.log(err);\n                })\n        }\n    }\n\n    function handleCardDelete(card) {\n        api\n            .removeCard(card._id)\n            .then(() => {\n                const updatedList = cards.filter((c) => c._id !== card._id);\n                setCards(updatedList);\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n\n    }\n\n    //popups \n    function handleAddPlaceOpen() {\n        setIsAddPlaceOpen(true);\n    }\n\n    function handleCardClick(card) {\n        setSelectedCard(card)\n    }\n\n    function handleEditAvatarOpen() {\n        setIsEditAvatarOpen(true);\n    }\n\n    function handleEditProfileOpen() {\n        setIsEditProfileOpen(true);\n    }\n\n    function handleInfoToolTipOpen() {\n        setIsInfoToolTipOpen(true);\n    }\n\n    function closeAllPopups() {\n        setIsAddPlaceOpen(false);\n        setIsEditAvatarOpen(false);\n        setIsEditProfileOpen(false);\n        setIsInfoToolTipOpen(false);\n        setSelectedCard(null);\n    }\n\n    function handleUpdateUser(newUser) {\n        api.setUserInfo({ name: newUser.name, about: newUser.about })\n            .then((res) => {\n                setCurrentUser({\n                    ...currentUser,\n                    name: newUser.name,\n                    about: newUser.about\n                })\n            })\n            .then(closeAllPopups)\n            .catch((err) => {\n                console.log(err);\n            })\n    }\n\n    function handleUpdateAvatar(newUser) {\n        api.setUserPic({ avatar: newUser.avatar })\n            .then(() => {\n                setCurrentUser({\n                    ...currentUser,\n                    avatar: newUser.avatar\n                })\n            })\n            .then(closeAllPopups)\n            .catch((err) => {\n                console.log(err);\n            })\n    }\n\n    function handleAddPlaceSubmit(card) {\n        api.addCard({ name: card.name, link: card.link })\n            .then((card) => {\n                setCards([card, ...cards])\n            })\n\n            .then(closeAllPopups)\n            .catch((err) => {\n                console.log(err);\n            })\n    }\n\n    return (\n\n        <CurrentUserContext.Provider value={currentUser}>\n            <div className=\"App\">\n                <Header loggedIn={loggedIn} userData={userData} onLogOut={handleLogOut} />\n\n                <ImagePopup\n                    card={selectedCard}\n                    onClose={closeAllPopups}\n                />\n\n                <AddPlacePopup isOpen={addPlacePopupOpen} onClose={closeAllPopups} onAddPlace={handleAddPlaceSubmit} />\n\n                <EditAvatarPopup isOpen={editAvatarPopupOpen} onClose={closeAllPopups} onUpdateAvatar={handleUpdateAvatar} />\n\n                <EditProfilePopup isOpen={editProfilePopupOpen} onClose={closeAllPopups} onUpdateUser={handleUpdateUser} />\n\n                <InfoToolTip isOpen={infoToolTipOpen} onClose={closeAllPopups} isRegistered={register} />\n\n                <Switch>\n\n                    <ProtectedRoute exact path=\"/main\"\n                        loggedIn={loggedIn}\n                        component={Main}\n                        cards={cards}\n                        handleCardClick={handleCardClick}\n                        onAddPlace={handleAddPlaceOpen}\n                        onCardDelete={handleCardDelete}\n                        onCardLike={handleCardLike}\n                        onClose={closeAllPopups}\n                        onEditAvatar={handleEditAvatarOpen}\n                        onEditProfile={handleEditProfileOpen}>\n                    </ProtectedRoute>\n\n                    <Route exact path=\"/signup\">\n                        <Register onSubmit={handleRegister} />\n                    </Route>\n\n                    <Route exact path=\"/signin\">\n                        <Login onSubmit={handleLogin} />\n                    </Route>\n\n                    <Route exact path=\"/\">\n                        {loggedIn\n                            ? <Redirect to=\"/main\" />\n                            : <Redirect to=\"/signin\" />}\n                    </Route>\n\n                </Switch>\n                {loggedIn && <Footer />}\n            </div>\n        </CurrentUserContext.Provider>\n\n    )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}